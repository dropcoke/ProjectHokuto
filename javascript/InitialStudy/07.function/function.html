<!doctype html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="./function.js"></script>
    <script type="text/javascript" src="../jquery-3.6.1.min.js"></script>
    <script src="../jquery-linedtextarea.js"></script>
    <link href="../jquery-linedtextarea.css" rel="stylesheet"/>
    <script>
      $(function(){
        // const bodyOut = document.getElementById("body");
        // const bodyContent = document.getElementsByTagName("body");
        // bodyOut.innerHTML = bodyContent[0].innerHTML;
        $(".lined").linedtextarea({
          selectedLine: 1
        });
      });
    </script>
  </head>
  <body>
    <header><a href="../index.html">&lt; 最初に戻る</a></header>
    <div>
      <h2>コマンド(関数)</h2>
      <p>自分で作った処理を再利用しよう</p>
      <p>コマンド(関数)とは与えられた値をもとに。定められた独自の処理を実行してその結果を返します。</p>
    </div>
    <div><button onclick="">プログラム実行</button></div>
    <div style="margin-top: 30px">
      ここでコマンド(関数)を作成して実行した結果を、コンソールと画面に表示します。<br />
      <p>
        <h3>コンソールプログラム</h3>
        <h4>引数がなく全ての商品を取得するコマンド(関数)</h4>
        <div>
          以下のプログラムを「function.js」に書いてみましょう。
          <p>
            <textarea class="lined" readonly style="width: 600px; height: 360px;">
// 自販機のジュースのリスト
const drink = [
    {price: 120, name: "缶コーヒー"}, // 0
    {price: 120, name: "オレンジジュース"} , // 1
    {price: 150, name: "ミックスジュース"}, // 2
    {price: 140, name: "おーいお茶"}, // 3
    {price: 100, name: "南アルプス天然水"}, // 4
    {price: 120, name: "ウィルキンソン強炭酸水"}]; // 5

// コマンド(関数)を宣言します。
// 1. 自動販売機にあるジュースのリストを取得します。
const getJuiceList = () => {
    let vendingMachine = "販売商品のリスト \n";
    for (let i = 0; i < drink.length; i++) {
        const number = i + 1
        // 商品情報
        vendingMachine +=  number + "番: " + drink[i].name + " 価格: " + drink[i].price + "円\n";
    }
    return vendingMachine;
}

// 1. 引数がないパターン
console.log(getJuiceList());
            </textarea>
          </p>
          <div><button onclick="">プログラム実行</button></div>
          プログラムを書いたらファイルを保存して「プログラム実行」ボタンをクリックしてください。<br />
          自動販売機の中身が見れましたか?<br />
          getJuiceListと言うコマンド(関数)を作って、そのコマンド(関数)を呼び出します。<br />
          そもそもコマンド(関数)って何?<br />
          与えられた値(引数とかパラメータなどと言います)をもとに、<br />
          定められた独自の処理を実行し、その結果を返す命令のことです。<br />
          実際には引数が与えられなかったり、その結果を返さないようなコマンド(関数)も利用できます。<br />
          上記のコマンド(関数)には引数がありません。<br />
          今回作ったコマンド(関数)getJuiceListではdrinkと言う配列に格納した要素を展開して<br />
          その情報を変数に代入して返します。(return vendingMachine; がそれです。 )<br />
          今までは結果を表示するために画面を再描画する必要がありましたが、<br />
          コマンド(関数)を使うと下のボタンをクリックすることで同じ処理を実行することができます。<br />
          <div><button onclick="console.log(getJuiceList());">getJuiceListを実行する。</button></div>
          結果を返さない場合を試してみてください。<br />
          20行目の<br />
          return vendingMachine; <br />
          を削除してください。17行目のプログラムを改行して<br />
          console.log("今は" +  drink[i].name + "取り出しています。" );<br />
          を18行目に書いて再描画してください。
        </div>
        <h4>引数から商品を取得するコマンド(関数)</h4>
        <div>
          以下のプログラムを「function.js」に書いてみましょう。<br />
          <p>
            <textarea class="lined" readonly style="width: 600px; height: 300px;">
const drink = [
    {price: 120, name: "缶コーヒー"}, // 0
    {price: 120, name: "オレンジジュース"} , // 1
    {price: 150, name: "ミックスジュース"}, // 2
    {price: 140, name: "おーいお茶"}, // 3
    {price: 100, name: "南アルプス天然水"}, // 4
    {price: 120, name: "ウィルキンソン強炭酸水"}]; // 5
// コマンド(関数)を宣言します (以下のように書くこともできます)
// 2. 自動販売機のジュースを選びます
function getJuice(number) {
    const target = number - 1;
    if (target > drink.length) {
        alert ("選択したジュースは存在しません。")
    }
    let vendingMachine = "選択商品 \n";
    // 選択したジュースの値段
    const price = drink[target].price;
    // 選択したジュースの名前
    const name = drink[target].name;
    // 選択した商品情報
    vendingMachine += name + " 価格: " + price + "円\n";
    return vendingMachine;
}
// 2. 引数にジュースの番号を設定します。
console.log(getJuice(1));
          </textarea>
          </p>
          <div><button onclick="">プログラム実行</button></div>
          プログラムを書いたらファイルを保存して「プログラム実行」ボタンをクリックしてください。<br />
          自動販売機のどの飲料が取得できましたか?<br />
          getJuiceと言うコマンド(関数)を作って、そのコマンド(関数)を呼び出します。<br />
          今回作ったコマンド(関数)getJuiceListではdrinkと言う配列に格納した要素の中から一つを取得して<br />
          その情報を変数に代入して返します。(return vendingMachine; がそれです。 )<br />
          下のボタンをクリックすることでどんな飲み物が取得できるのか試してみてください。<br />
          <div><button onclick="console.log(getJuice(Math.floor(Math.random() * 5 + 1)));">getJuiceを実行する。</button></div>
        </div>
        <h4>引数から商品と投入金額を設定して購入状態を取得するコマンド(関数)</h4>
        <div>
          以下のプログラムを「function.js」に書いてみましょう。<br />
          <p>
            <textarea class="lined" readonly style="width: 600px; height: 480px;">
const drink = [
    {price: 120, name: "缶コーヒー"}, // 0
    {price: 120, name: "オレンジジュース"} , // 1
    {price: 150, name: "ミックスジュース"}, // 2
    {price: 140, name: "おーいお茶"}, // 3
    {price: 100, name: "南アルプス天然水"}, // 4
    {price: 120, name: "ウィルキンソン強炭酸水"}]; // 5
// コマンド(関数)を宣言します。
// 3. ジュースを選んでお金を投入して購入します。
const buyJuice = (number, pay) => {
    const target = number - 1;
    // 選択したジュースの値段
    const price = drink[target].price;
    // 選択したジュースの名前
    const name = drink[target].name;
    // お釣り
    let  change = pay - price;
    let changeMessage = "購入しました。";
    // 金額が不足している
    if (change < 0) {
        change = change * -1;
        changeMessage = change + "円足りません。"
    }
    // お釣りがある
    else if (change > 0) {
    changeMessage = change + "円のお釣りです。"
    }
    let message = name + "は" +  price + "円です。\n支払い金額は" + pay + "円で" + changeMessage;
    return message;
}
// 3. ジュースの番号を設定してお金を投入します。
console.log(buyJuice(1, 100));
            </textarea>
          </p>
          <div><button onclick="">プログラム実行</button></div>
          プログラムを書いたらファイルを保存して「プログラム実行」ボタンをクリックしてください。<br />
          自動販売機のどの飲料を選んでちゃんと購入できましたかd?<br />
          buyJuiceと言うコマンド(関数)を作って、そのコマンド(関数)を呼び出します。<br />
          今回作ったコマンド(関数)buyJuiceではdrinkと言う配列に格納した要素の中から一つ何かを取得して、<br />
          金額を支払い実際に購入しようとします。<br />
          投入金額が少なければ購入できませんし、投入金額が多ければお釣りが発生します。<br />
          選択した飲料の情報と購入状況を変数に代入して返します。(return message; がそれです。 )<br />
          下のボタンをクリックすることでどんな飲み物が購入できたるのか試してみてください。<br />
          <div><button onclick="console.log(buyJuice(Math.floor(Math.random() * 5 + 1), 120));">buyJuiceを実行する。</button></div>
        </div>
      </p>
      <p>
        <h3>画面表示</h3>

        <div>
          以下のプログラムを「function.js」に書いてみましょう。<br />
          <p>
            <textarea class="lined" readonly style="width: 600px; height: 700px;">
const drink = [
    {price: 120, name: "缶コーヒー"}, // 0
    {price: 120, name: "オレンジジュース"} , // 1
    {price: 150, name: "ミックスジュース"}, // 2
    {price: 140, name: "おーいお茶"}, // 3
    {price: 100, name: "南アルプス天然水"}, // 4
    {price: 120, name: "ウィルキンソン強炭酸水"}]; // 5
// コマンド(関数)を宣言します。
// 3. ジュースを選んでお金を投入して購入します。
const buyJuice = (number, pay) => {
    const target = number - 1;
    // 選択したジュースの値段
    const price = drink[target].price;
    // 選択したジュースの名前
    const name = drink[target].name;
    // お釣り
    let  change = pay - price;
    let changeMessage = "購入しました。";
    // 金額が不足している
    if (change < 0) {
        change = change * -1;
        changeMessage = change + "円足りません。"
    }
    // お釣りがある
    else if (change > 0) {
    changeMessage = change + "円のお釣りです。"
    }
    let message = name + "は" +  price + "円です。\n支払い金額は" + pay + "円で" + changeMessage;
    return message;
}
// 画面に実行結果を表示します。
// プログラム実行
const execute = () => {
    // ジュースを選択
    const selectedJuice = document.getElementById("number").value;
    // お金を投入
    const payment = document.getElementById("payment").value;
    const target = document.getElementById("output");
    if (Number(selectedJuice) < 1 || drink.length <= Number(selectedJuice)) {
        target.textContent = "その飲料はありません。"
        return;
    }
    // target.textContent = getJuiceList();
    // target.textContent = getJuice(selectedJuice);
    target.textContent = buyJuice(selectedJuice, payment);
}
          </textarea>
          </p>
          <div><button onclick="">プログラム実行</button></div>
          プログラムを書いたらファイルを保存して「プログラム実行」ボタンをクリックしてください。<br />
          <div style="margin-top: 10px;">
            <button onclick="execute()">プログラム実行!</button>
            <pre>
              <div id="output" style="font-size: 1.5rem">初期状態</div>
            </pre>
            商品番号: <input type="number" id="number" value="1" /> 投入金額: <input type="number" id="payment" value="100" />
          </div>
          「プログラム実行」ボタンをクリックしてください。<br />
          ボタンをクリックしたら代入した値が表示されましたか?<br />
          ページのソースに&lt;button onclick="execute()"&gt;と書かれている部分があります。<br />
          これはfunction.jsに書かれている「execute」と言うコマンド(関数)を実行してくださいと命令しています。<br />
          コマンド(関数)executeでは&lt;input type="number" id="number" value="1" /&gt;で設定した商品番号と<br />
          &lt;input type="number" id="payment" value="100" /&gt;で設定した金額を引数にして<br />
          コマンド(関数)buyJuiceを実行して、その結果の飲料情報と購入状況を<br />
          &lt;div id="output"&gt;&lt;/div&gt;に表示してくださいと命令しています。<br />
          const target = document.getElementById("output");<br />
          はidがoutputの領域を取得してくださいと命令しています。<br />
          target.textContent = buyJuice(selectedJuice, payment);<br />
          は取得した領域のtextContentに選択した飲料の情報と購入状況を設定してくださいと命令しています。<br />
          textContentは領域内に表示する文字になります。<br />
          <a href="https://qiita.com/RyBB/items/c87af2413c34f9367d00" target="_blank">textContentとinnerHTMLの違い</a><br />
          またdrink.indexOf(selectedJuice)で選択商品が存在しているか確認して、<br />
          ない場合はその商品がないメッセージを表示します。
        </div>
      </p>
      <b>いろんな値を入力して飲料が購入できるか試してみましょう。</b>
    </div>
    <footer><a href="../index.html">&lt; 最初に戻る</a></footer>
  </body>
</html>

